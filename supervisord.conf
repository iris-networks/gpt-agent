      
[supervisord]
nodaemon=true
logfile=/dev/null
logfile_maxbytes=0
pidfile=/tmp/supervisord.pid

[program:xserver]
# Runs the VNC X server session
command=/usr/bin/Xvnc :1 -desktop VNCDesktop -localhost no -SecurityTypes VncAuth -rfbauth /home/abc/.vnc/passwd -geometry %(ENV_VNC_RESOLUTION)s -depth 24 -fg -AlwaysShared
user=abc
autostart=true
autorestart=true
priority=10
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
environment=HOME="/home/abc",USER="abc"

[program:openbox]
# Runs the lightweight window manager within the VNC session
command=/usr/bin/openbox-session
user=abc
autostart=true
autorestart=true
priority=20
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
environment=DISPLAY=":1",HOME="/home/abc",USER="abc"

[program:novnc]
# Runs the websockify proxy for noVNC
command=/usr/bin/websockify --web=/usr/local/novnc 6901 localhost:5901
user=abc  # Can run as abc or root, doesn't matter much
autostart=true
autorestart=true
priority=30
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:nodeapp]
# Runs your Node.js application as root
command=node index.js # <-- !!! ADJUST this to your actual start command, e.g., node dist/index.js !!!
directory=/app
user=root
autostart=true
autorestart=true
priority=40
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
# --- CRITICAL: Provide environment for Nut.js to connect to abc's display ---
environment=DISPLAY=":1",XAUTHORITY="/home/abc/.Xauthority"